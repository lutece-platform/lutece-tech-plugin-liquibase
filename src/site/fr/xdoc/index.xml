<?xml version="1.0" encoding="UTF-8"?>
<document>
	<properties>
		<title>Plugin liquibase</title>
	</properties>
	<head>
		<meta name="keywords" content="liquibase, sql" />
	</head>
	<body>
			<!--
            <p>
                <img src="images/liquibase.png"
			/>
            </p>
            -->
			<section name="Introduction">
				<p>This plugin allows for automatic execution of SQL scripts at application startup. Several modes are supported :
					<ul>
						<li>Creation : if the database is empty, all create and init scripts will be run.</li>
						<li>Migration : if this plugin was not in use in the previous version, the (previously non empty) database will be configured to use the plugin.</li>
						<li>Update : newly detected scripts will be run.</li>
					</ul>
				</p>
			</section>
			<section name="Configuration">
				<p>
					Par défaut, le plugin ne fait rien. Toutes les configurations sont définies dans le fichier <code>liquibase-plugin.properties</code>.
				</p>
				<subsection name="Propriétés générales">
					<table>
						<tr>
							<th>Propriété</th>
							<th>Description</th>
							<th>Valeur par défaut</th>
						</tr>
						<tr>
							<td><code>liquibase.enabled.at.startup</code></td>
							<td>Activer l'exécution du plugin au démarrage de l'application</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.first.run.request</code></td>
							<td>Requête SQL pour vérifier s'il s'agit de la première exécution (vérifie la table DATABASECHANGELOG)</td>
							<td>select count(*) FROM information_schema.tables where table_name='DATABASECHANGELOG';</td>
						</tr>
						<tr>
							<td><code>liquibase.empty.db.request</code></td>
							<td>Requête SQL pour vérifier si la base de données est vide</td>
							<td>SELECT count(*) FROM information_schema.tables where table_schema=database();</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Contrôle de version">
					<table>
						<tr>
							<th>Propriété</th>
							<th>Description</th>
							<th>Valeur par défaut</th>
						</tr>
						<tr>
							<td><code>liquibase.accept.unstable.versions</code></td>
							<td>Autoriser l'exécution de liquibase sur les fichiers de mise à jour des versions instables (alpha, beta, rc) à chaque démarrage</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.accept.snapshot.versions</code></td>
							<td>Autoriser l'exécution de liquibase sur les fichiers de mise à jour des versions snapshot à chaque démarrage</td>
							<td>false</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Mode de simulation (Dry Run)">
					<table>
						<tr>
							<th>Propriété</th>
							<th>Description</th>
							<th>Valeur par défaut</th>
						</tr>
						<tr>
							<td><code>liquibase.dryrun</code></td>
							<td>Activer le mode de simulation pour générer un script SQL au lieu d'appliquer les modifications à la base de données</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.dryrun.output.file</code></td>
							<td>Chemin du fichier de sortie pour le script SQL en mode simulation</td>
							<td>WEB-INF/plugins/liquibase/liquibase-dryrun.sql</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Analytique et journalisation">
					<table>
						<tr>
							<th>Propriété</th>
							<th>Description</th>
							<th>Valeur par défaut</th>
						</tr>
						<tr>
							<td><code>liquibase.analytics.enabled</code></td>
							<td>Activer l'envoi d'analytiques à Liquibase</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.sql.logLevel</code></td>
							<td>Définir le niveau de journalisation pour la sortie SQL (OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST, ALL, DEBUG)</td>
							<td>DEBUG</td>
						</tr>
					</table>
				</subsection>
			</section>
	</body>
</document>
