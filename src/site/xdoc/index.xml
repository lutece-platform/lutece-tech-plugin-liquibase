<?xml version="1.0" encoding="UTF-8"?>
<document>
	<properties>
		<title>Plugin liquibase</title>
	</properties>
	<head>
		<meta name="keywords" content="liquibase, sql" />
	</head>
	<body>
			<!--
            <p>
                <img src="images/liquibase.png"
			/>
            </p>
            -->
			<section name="Introduction">
				<p>This plugin allows for automatic execution of SQL scripts at application startup. Several modes are supported :
					<ul>
						<li>Creation : if the database is empty, all create and init scripts will be run.</li>
						<li>Migration : if this plugin was not in use in the previous version, the (previously non empty) database will be configured to use the plugin.</li>
						<li>Update : newly detected scripts will be run.</li>
					</ul>
				</p>
			</section>
			<section name="Configuration">
				<p>
					By default the plugin does nothing. All configurations are defined in the <code>liquibase-plugin.properties</code> file.
				</p>
				<subsection name="General Properties">
					<table>
						<tr>
							<th>Property</th>
							<th>Description</th>
							<th>Default Value</th>
						</tr>
						<tr>
							<td><code>liquibase.enabled.at.startup</code></td>
							<td>Enable the plugin execution at application startup</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.first.run.request</code></td>
							<td>SQL query to check if this is the first run (checks for DATABASECHANGELOG table)</td>
							<td>select count(*) FROM information_schema.tables where table_name='DATABASECHANGELOG';</td>
						</tr>
						<tr>
							<td><code>liquibase.empty.db.request</code></td>
							<td>SQL query to check if the database is empty</td>
							<td>SELECT count(*) FROM information_schema.tables where table_schema=database();</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Version Control">
					<table>
						<tr>
							<th>Property</th>
							<th>Description</th>
							<th>Default Value</th>
						</tr>
						<tr>
							<td><code>liquibase.accept.unstable.versions</code></td>
							<td>Allow running liquibase on update files of unstable versions (alpha, beta, rc) at every startup</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.accept.snapshot.versions</code></td>
							<td>Allow running liquibase on update files of snapshot versions at every startup</td>
							<td>false</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Dry Run Mode">
					<table>
						<tr>
							<th>Property</th>
							<th>Description</th>
							<th>Default Value</th>
						</tr>
						<tr>
							<td><code>liquibase.dryrun</code></td>
							<td>Enable dry run mode to output SQL script instead of applying changes to the database</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.dryrun.output.file</code></td>
							<td>Path to the output file for dry run SQL script</td>
							<td>WEB-INF/plugins/liquibase/liquibase-dryrun.sql</td>
						</tr>
					</table>
				</subsection>
				<subsection name="Analytics and Logging">
					<table>
						<tr>
							<th>Property</th>
							<th>Description</th>
							<th>Default Value</th>
						</tr>
						<tr>
							<td><code>liquibase.analytics.enabled</code></td>
							<td>Enable sending analytics to Liquibase</td>
							<td>false</td>
						</tr>
						<tr>
							<td><code>liquibase.sql.logLevel</code></td>
							<td>Set log level for SQL output (OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST, ALL, DEBUG)</td>
							<td>DEBUG</td>
						</tr>
					</table>
				</subsection>
			</section>
			
	</body>
</document>
